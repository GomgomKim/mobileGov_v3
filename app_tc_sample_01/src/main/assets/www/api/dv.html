<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>가상화앱 문서뷰어 테스트앱(Hybrid)</title>

    <script src="../js/jquery-commonbased.min.js"></script>
    <script src="../js/CommonBaseAdapter.3.0.0.js"></script>

    <script type="text/javascript">
        var dvhost = "10.180.22.77:65535";
        function runDv(idx) {
            var file_name;
            var file_url;

            switch(idx) {
                case 1:
                    file_name = 'sample.hwp';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample.hwp';
                    file_url = encodeURIComponent(file_url);
                    break;

                case 2:
                    file_name = 'sample_1p.hwp';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample_1p.hwp';
                    file_url = encodeURIComponent(file_url);
                    //file_url = encodeURIComponent(file_url);
                    break;

                case 3:
                    file_name = 'sample.pdf';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample.pdf';
                    file_url = encodeURIComponent(file_url);
                    //file_url = encodeURIComponent(file_url);
                    break;

                case 4:
                    file_name = 'sample.xlsx';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample.xlsx';
                    file_url = encodeURIComponent(file_url);
                    //file_url = encodeURIComponent(file_url);
                    break;

                case 5:
                    file_name = 'sample.jpg';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample.jpg';
                    file_url = encodeURIComponent(file_url);
                    //file_url = encodeURIComponent(file_url);
                    break;

                case 6:
                    file_name = 'sample.png';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample.png';
                    file_url = encodeURIComponent(file_url);
                    //file_url = encodeURIComponent(file_url);
                    break;

                case 7:
                   file_name = 'sample.png';
                    file_url = 'http://' + dvhost + '/MOI_API/file/sample.pptx';
                    file_url = encodeURIComponent(file_url);
                    break;


                default:
                    file_name = '';
                    file_url = '';
            }

            // 문서뷰어 요청
            CommonBaseAPI.Broker.startDefaultDocumentView(
                // 문서뷰어 요청 성공
                function(result) {
                    console.log('document viewer result=' + result);
                },
                // 문서뷰어 요청 실패
                function(code, msg) {
                    console.log('document viewer error=' + code + ', ' + msg);
                },
                // 문서뷰어로 요청할 문서 정보
                file_url,
                file_name,
                ""
            );
        }
    </script>
</head>
<style>
    .button {
        width: 100%;
        display: block;
        border: 1px solid transparent;
        padding: 13px 32px;
        cursor: pointer;
        margin-top: 10px;
        border-radius: .25rem;
        font-family: "Lucica Console", Monaco, monospace;
        margin-bottom: 10px;
    }
</style>
<body style="background-color:white;" onload="onLoad()">
<h1>가상화 테스트앱(Hybrid)</h1>
<h2>Document Viewer API</h2>
<br>

<center>
    <p>
        <button class="button" onclick="runDv(1)">sample.hwp</button>
        <button class="button" onclick="runDv(2)">sample_p1.hwp(x)</button>
        <button class="button" onclick="runDv(3)">sample.pdf</button>
        <button class="button" onclick="runDv(4)">sample.xlsx</button>
        <button class="button" onclick="runDv(5)">sample.jpg(x)</button>
        <button class="button" onclick="runDv(6)">sample.png(x)</button>
        <button class="button" onclick="runDv(7)">sample.pptx</button>
    </p>

</center>

</body>
</html>